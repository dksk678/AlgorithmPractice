# [Gold III] 정육면체한버더굴리기

[문제 링크](https://www.codetree.ai/training-field/frequent-problems/problems/maze-tower-defense/description?page=1&pageSize=20)

### 성능 요약

메모리: 10 MB, 시간: 114 ms

### 분류

시뮬레이션, dxdy technique

### 문제 설명

https://www.codetree.ai/training-field/frequent-problems/problems/maze-tower-defense/description?page=1&pageSize=20

n x n으로 이뤄진 나선형 미로 속에 1번, 2번, 3번 몬스터들이 침략하고 있습니다.

플레이어는 격자 속 가운데 탑에서 몬스터를 제거하려고 합니다. 몬스터는 다음 방법에 따라 제거됩니다.

플레이어는 상하좌우 방향 중 주어진 공격 칸 수만큼 몬스터를 공격하여 없앨 수 있습니다.

비어있는 공간만큼 몬스터는 앞으로 이동하여 빈 공간을 채웁니다.

이때 몬스터의 종류가 4번 이상 반복하여 나오면 해당 몬스터 또한 삭제됩니다. 해당 몬스터들은 동시에 사라집니다.

삭제된 이후에는 몬스터들을 앞으로 당겨주고, 4번 이상 나오는 몬스터가 있을 경우 또 삭제를 해줍니다. 4번 이상 나오는 몬스터가 없을 때까지 반복해줍니다.

삭제가 끝난 다음에는 몬스터를 차례대로 나열했을 때 같은 숫자끼리 짝을 지어줍니다. 이후 각각의 짝을 (총 개수, 숫자의 크기)로 바꾸어서 다시 미로 속에 집어넣습니다.

만약 새로 생긴 배열이 원래 격자의 범위를 넘는다면 나머지 배열은 무시합니다.

해당 과정이 끝나면 한 라운드가 끝납니다. 1과 3 과정에서 삭제되는 몬스터의 번호는 점수에 합쳐집니다. 예를 들어 위의 1번 과정에서는 총 (2 _ 2) = 4점만큼 점수가 추가되고, 3번 과정에서는 (1 _ 5) + (3 _ 4) + (2 _ 4) = 25점만큼 점수가 추가됩니다. 해당 라운드에서 합쳐진 점수는 총 29점입니다.

각 라운드별로 공격 방향과 공격하는 칸 수가 주어질 때 모든 라운드가 끝난 후 플레이어가 얻게되는 점수는 몇 점인지 구하는 프로그램을 작성하세요.

### 입력

첫번째 줄에는 격자의 크기 n, 총 라운드 수 m이 주어집니다.

이후 두번째 줄부터 n+1번째 줄까지 몬스터의 종류가 주어집니다. 0은 비어있는 칸을 의미합니다.

이후 m개의 줄에는 각 라운드마다의 플레이어의 공격 방향 d과 공격 칸 수 p가 주어집니다.

d는 0번부터 3번까지 각각 → ↓ ← ↑으로 주어집니다.

7 ≤ n ≤ 25(n은 홀수)

1 ≤ m ≤ 100

0 ≤ d ≤ 3

0 ≤ (주어지는 몬스터의 종류) ≤ 3

1 ≤ p ≤ floor(n/2)

입력되는 몬스터의 줄 사이에는 공백이 존재하지 않습니다.

정가운데 칸은 몬스터가 주어지지 않는다고 가정해도 좋습니다.

입력:

7 1
0 0 0 0 0 0 0
0 0 0 1 3 2 0
0 3 2 3 3 2 0
0 1 1 0 2 2 0
0 2 2 3 3 2 0
0 1 1 1 1 1 0
0 0 0 0 0 0 0
0 2

### 출력

모든 라운드가 끝난 후 플레이어가 얻은 점수를 출력하세요.

출력:

29
